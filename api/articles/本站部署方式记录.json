{"title":"本站部署方式记录","slug":"本站部署方式记录","date":"2024-04-20T15:32:55.000Z","updated":"2024-05-19T07:54:17.000Z","comments":true,"path":"api/articles/本站部署方式记录.json","excerpt":null,"covers":["/assets/post-img/@d342eda4-1.png","/assets/post-img/@d342eda4-2.png","/assets/post-img/@d342eda4-3.png","/assets/post-img/@d342eda4-5.png","/assets/post-img/@d342eda4-6.png","/assets/post-img/@d342eda4-7.png","/assets/post-img/@d342eda4-8.png","/assets/post-img/@d342eda4-9.png","/assets/post-img/@d342eda4-10.png","https://static.vayfou.cn/img/screenshot.png"],"content":"<div class=\"note \"><p>本文偏向于记录备份，非教程，仅供参考。</p></div>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本站使用了 <a href=\"https://github.com/\">GitHub</a> &#x2F; <a href=\"https://cloudflare.com/\">Cloudflare</a> &#x2F; <a href=\"https://vercel.com/\">Vercel</a> 等服务进行部署，详细结构如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">├── Github      # 代码存储</span><br><span class=\"line\">├── Vercel      # 项目部署</span><br><span class=\"line\">├── Cloudflare  # DNS / CDN</span><br></pre></td></tr></table></figure>\n<h2 id=\"部署记录\"><a href=\"#部署记录\" class=\"headerlink\" title=\"部署记录\"></a>部署记录</h2><h3 id=\"1-GitHub-存储\"><a href=\"#1-GitHub-存储\" class=\"headerlink\" title=\"1.GitHub 存储\"></a>1.GitHub 存储</h3><p>通过将 Hexo 静态文件 <a href=\"/9d3d3152/#3-Git-%E6%8E%A8%E9%80%81\">推送</a> 至 GitHub 代码仓库，以实现代码文件存储。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">打开终端，输入：</span></span><br><span class=\"line\">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-Vercel-项目部署\"><a href=\"#2-Vercel-项目部署\" class=\"headerlink\" title=\"2.Vercel 项目部署\"></a>2.Vercel 项目部署</h3><p>将 Vercel 连接 GitHub 账号，并点击 <code>Add New</code> 新建项目，将代码仓库（上述推送的静态文件仓库）导入 Vercel ，再点击 <code>Import</code> 绑定项目。</p>\n<p><img src=\"/assets/post-img/@d342eda4-1.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Vercel-Import\"></p>\n<p>然后点击 <code>Deploy</code> 部署项目。</p>\n<p><img src=\"/assets/post-img/@d342eda4-2.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Vercel-Deploy\"></p>\n<div class=\"note warning\"><p>由于 Vercel 分配的子域名 <code>*.vercel.app</code> 被大陆 DNS 污染，所以需绑定自己的域名以实现正常访问。</p></div>\n<h3 id=\"3-Cloudflare-DNS-CDN\"><a href=\"#3-Cloudflare-DNS-CDN\" class=\"headerlink\" title=\"3.Cloudflare DNS &#x2F; CDN\"></a>3.Cloudflare DNS &#x2F; CDN</h3><p>本站域名使用了 Cloudflare 的 DNS 服务器。</p>\n<p><img src=\"/assets/post-img/@d342eda4-3.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Cloudflare-Home\"></p>\n<p>在域名注册网站把 DNS 服务器 Nameservers 解析到 Cloudflare 。</p>\n<p>打开 <code>DNS</code> - <code>记录</code> ，点击添加记录，将域名按照提示解析到 Vercel ，等待解析完成即可。</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">@ 76.76.21.21</span><br><span class=\"line\">CNAME cname.vercel.com</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/assets/post-img/@d342eda4-5.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-5.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Vercel-DNS\"></p>\n<p>为防止大陆 GFW 解析的域名，可以将解析到 Vercel 的 DNS 替换为：</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">@ 76.223.126.88</span><br><span class=\"line\">CNME cname-china.vercel.com</span><br></pre></td></tr></table></figure>\n\n<div class=\"note warning\"><p>需先将域名解析至 Vercel 提供的默认 DNS 服务器，以防止 SSL 证书配置失败的问题。</p></div>\n\n<p><img src=\"/assets/post-img/@d342eda4-6.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-6.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Cloudflare-DNS\"></p>\n<h2 id=\"规则配置\"><a href=\"#规则配置\" class=\"headerlink\" title=\"规则配置\"></a>规则配置</h2><h3 id=\"1-CDN-加速\"><a href=\"#1-CDN-加速\" class=\"headerlink\" title=\"1.CDN 加速\"></a>1.CDN 加速</h3><p>打开 <code>DNS</code> - <code>记录</code> ，打开 <code>橙云</code> 以开启（默认状态应为打开）。</p>\n<div class=\"note warning\"><p>因 Cloudflare 服务器均不在大陆，所以加速效果也许不会太好（但依然可起保护作用），开启后若感觉速度明显降低，严重影响访客访问体验，则可暂时进行关闭，继续使用 Vercel 提供的默认 DNS 服务器。</p></div>\n<h3 id=\"2-DDOS-防御\"><a href=\"#2-DDOS-防御\" class=\"headerlink\" title=\"2.DDOS 防御\"></a>2.DDOS 防御</h3><p>打开 <code>安全性</code> - <code>DDoS</code> ，点击 <code>部署DDoS替代</code> ：</p>\n<p><img src=\"/assets/post-img/@d342eda4-7.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-7.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Cloudflare-DDos\"></p>\n<p>配置如下：</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">替代名称：ddos</span><br><span class=\"line\">规则集操作：阻止</span><br><span class=\"line\">规则集敏感度：高</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/assets/post-img/@d342eda4-8.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-8.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Cloudflare-DDos\"></p>\n<h3 id=\"3-速度限制\"><a href=\"#3-速度限制\" class=\"headerlink\" title=\"3.速度限制\"></a>3.速度限制</h3><p>打开 <code>安全性</code> - <code>WAF</code> - <code>速度限制规则</code> ，点击创建规则：</p>\n<p><img src=\"/assets/post-img/@d342eda4-9.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-9.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Cloudflare-WAF\"></p>\n<p>配置如下：</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">速度名称：规则限制</span><br><span class=\"line\"></span><br><span class=\"line\">如果传入请求匹配 ↓</span><br><span class=\"line\">字段：URI路径 ，运算符：包含 ，值：/</span><br><span class=\"line\">注：上述规则可直接编辑表达式：(http.request.uri.path contains &quot;/&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">当速率超过 ↓</span><br><span class=\"line\">请求：35 ， 期间 10 秒钟</span><br><span class=\"line\"></span><br><span class=\"line\">然后采取措施 ↓</span><br><span class=\"line\">选择操作：阻止 ， 响应类型为：默认 Cloudflare 速度限制响应</span><br><span class=\"line\"></span><br><span class=\"line\">持续时间：10 秒钟</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-Error-解决\"><a href=\"#4-Error-解决\" class=\"headerlink\" title=\"4.Error 解决\"></a>4.Error 解决</h3><p>当访问部署的网站时提示 <code>重定向次数过多</code> 解决方法如下：</p>\n<p>打开 <code>SSL/TLS</code> - <code>概述</code> ， 将加密模式设置为 <code>完全</code> 即可。</p>\n<p><img src=\"/assets/post-img/@d342eda4-10.png\" class=\"lazyload\" data-srcset=\"/assets/post-img/@d342eda4-10.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Cloudflare-SSL/TLS\"></p>\n<p>若设置完成后，依然提示，则可暂时将 DNS 的 <code>橙云</code> 关闭。</p>\n<h3 id=\"5-清除缓存\"><a href=\"#5-清除缓存\" class=\"headerlink\" title=\"5.清除缓存\"></a>5.清除缓存</h3><p>上述所有操作完成后，需在 <code>缓存</code> - <code>配置</code> 页面，点击 <code>清除所有内容</code> 以使设置改动生效。</p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>完结撒花~🎉</p>\n<p><img src=\"https://static.vayfou.cn/img/screenshot.png\" class=\"lazyload\" data-srcset=\"https://static.vayfou.cn/img/screenshot.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"Blog-Home\"></p>\n","more":"<div class=\"note \"><p>本文偏向于记录备份，非教程，仅供参考。</p></div>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本站使用了 <a href=\"https://github.com/\">GitHub</a> &#x2F; <a href=\"https://cloudflare.com/\">Cloudflare</a> &#x2F; <a href=\"https://vercel.com/\">Vercel</a> 等服务进行部署，详细结构如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">├── Github      # 代码存储</span><br><span class=\"line\">├── Vercel      # 项目部署</span><br><span class=\"line\">├── Cloudflare  # DNS / CDN</span><br></pre></td></tr></table></figure>\n<h2 id=\"部署记录\"><a href=\"#部署记录\" class=\"headerlink\" title=\"部署记录\"></a>部署记录</h2><h3 id=\"1-GitHub-存储\"><a href=\"#1-GitHub-存储\" class=\"headerlink\" title=\"1.GitHub 存储\"></a>1.GitHub 存储</h3><p>通过将 Hexo 静态文件 <a href=\"/9d3d3152/#3-Git-%E6%8E%A8%E9%80%81\">推送</a> 至 GitHub 代码仓库，以实现代码文件存储。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">打开终端，输入：</span></span><br><span class=\"line\">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-Vercel-项目部署\"><a href=\"#2-Vercel-项目部署\" class=\"headerlink\" title=\"2.Vercel 项目部署\"></a>2.Vercel 项目部署</h3><p>将 Vercel 连接 GitHub 账号，并点击 <code>Add New</code> 新建项目，将代码仓库（上述推送的静态文件仓库）导入 Vercel ，再点击 <code>Import</code> 绑定项目。</p>\n<p><img src=\"/assets/post-img/@d342eda4-1.png\" alt=\"Vercel-Import\"></p>\n<p>然后点击 <code>Deploy</code> 部署项目。</p>\n<p><img src=\"/assets/post-img/@d342eda4-2.png\" alt=\"Vercel-Deploy\"></p>\n<div class=\"note warning\"><p>由于 Vercel 分配的子域名 <code>*.vercel.app</code> 被大陆 DNS 污染，所以需绑定自己的域名以实现正常访问。</p></div>\n<h3 id=\"3-Cloudflare-DNS-CDN\"><a href=\"#3-Cloudflare-DNS-CDN\" class=\"headerlink\" title=\"3.Cloudflare DNS &#x2F; CDN\"></a>3.Cloudflare DNS &#x2F; CDN</h3><p>本站域名使用了 Cloudflare 的 DNS 服务器。</p>\n<p><img src=\"/assets/post-img/@d342eda4-3.png\" alt=\"Cloudflare-Home\"></p>\n<p>在域名注册网站把 DNS 服务器 Nameservers 解析到 Cloudflare 。</p>\n<p>打开 <code>DNS</code> - <code>记录</code> ，点击添加记录，将域名按照提示解析到 Vercel ，等待解析完成即可。</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">@ 76.76.21.21</span><br><span class=\"line\">CNAME cname.vercel.com</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/assets/post-img/@d342eda4-5.png\" alt=\"Vercel-DNS\"></p>\n<p>为防止大陆 GFW 解析的域名，可以将解析到 Vercel 的 DNS 替换为：</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">@ 76.223.126.88</span><br><span class=\"line\">CNME cname-china.vercel.com</span><br></pre></td></tr></table></figure>\n\n<div class=\"note warning\"><p>需先将域名解析至 Vercel 提供的默认 DNS 服务器，以防止 SSL 证书配置失败的问题。</p></div>\n\n<p><img src=\"/assets/post-img/@d342eda4-6.png\" alt=\"Cloudflare-DNS\"></p>\n<h2 id=\"规则配置\"><a href=\"#规则配置\" class=\"headerlink\" title=\"规则配置\"></a>规则配置</h2><h3 id=\"1-CDN-加速\"><a href=\"#1-CDN-加速\" class=\"headerlink\" title=\"1.CDN 加速\"></a>1.CDN 加速</h3><p>打开 <code>DNS</code> - <code>记录</code> ，打开 <code>橙云</code> 以开启（默认状态应为打开）。</p>\n<div class=\"note warning\"><p>因 Cloudflare 服务器均不在大陆，所以加速效果也许不会太好（但依然可起保护作用），开启后若感觉速度明显降低，严重影响访客访问体验，则可暂时进行关闭，继续使用 Vercel 提供的默认 DNS 服务器。</p></div>\n<h3 id=\"2-DDOS-防御\"><a href=\"#2-DDOS-防御\" class=\"headerlink\" title=\"2.DDOS 防御\"></a>2.DDOS 防御</h3><p>打开 <code>安全性</code> - <code>DDoS</code> ，点击 <code>部署DDoS替代</code> ：</p>\n<p><img src=\"/assets/post-img/@d342eda4-7.png\" alt=\"Cloudflare-DDos\"></p>\n<p>配置如下：</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">替代名称：ddos</span><br><span class=\"line\">规则集操作：阻止</span><br><span class=\"line\">规则集敏感度：高</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/assets/post-img/@d342eda4-8.png\" alt=\"Cloudflare-DDos\"></p>\n<h3 id=\"3-速度限制\"><a href=\"#3-速度限制\" class=\"headerlink\" title=\"3.速度限制\"></a>3.速度限制</h3><p>打开 <code>安全性</code> - <code>WAF</code> - <code>速度限制规则</code> ，点击创建规则：</p>\n<p><img src=\"/assets/post-img/@d342eda4-9.png\" alt=\"Cloudflare-WAF\"></p>\n<p>配置如下：</p>\n<figure class=\"highlight txt\"><table><tr><td class=\"code\"><pre><span class=\"line\">速度名称：规则限制</span><br><span class=\"line\"></span><br><span class=\"line\">如果传入请求匹配 ↓</span><br><span class=\"line\">字段：URI路径 ，运算符：包含 ，值：/</span><br><span class=\"line\">注：上述规则可直接编辑表达式：(http.request.uri.path contains &quot;/&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">当速率超过 ↓</span><br><span class=\"line\">请求：35 ， 期间 10 秒钟</span><br><span class=\"line\"></span><br><span class=\"line\">然后采取措施 ↓</span><br><span class=\"line\">选择操作：阻止 ， 响应类型为：默认 Cloudflare 速度限制响应</span><br><span class=\"line\"></span><br><span class=\"line\">持续时间：10 秒钟</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-Error-解决\"><a href=\"#4-Error-解决\" class=\"headerlink\" title=\"4.Error 解决\"></a>4.Error 解决</h3><p>当访问部署的网站时提示 <code>重定向次数过多</code> 解决方法如下：</p>\n<p>打开 <code>SSL/TLS</code> - <code>概述</code> ， 将加密模式设置为 <code>完全</code> 即可。</p>\n<p><img src=\"/assets/post-img/@d342eda4-10.png\" alt=\"Cloudflare-SSL/TLS\"></p>\n<p>若设置完成后，依然提示，则可暂时将 DNS 的 <code>橙云</code> 关闭。</p>\n<h3 id=\"5-清除缓存\"><a href=\"#5-清除缓存\" class=\"headerlink\" title=\"5.清除缓存\"></a>5.清除缓存</h3><p>上述所有操作完成后，需在 <code>缓存</code> - <code>配置</code> 页面，点击 <code>清除所有内容</code> 以使设置改动生效。</p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>完结撒花~🎉</p>\n<p><img src=\"https://static.vayfou.cn/img/screenshot.png\" alt=\"Blog-Home\"></p>\n","categories":[{"name":"博客","path":"api/categories/博客.json"}],"tags":[{"name":"GitHub","path":"api/tags/GitHub.json"},{"name":"Blog","path":"api/tags/Blog.json"},{"name":"Cloudflare","path":"api/tags/Cloudflare.json"}]}